<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="schedule">
	
	<insert id="insertScheduleInfo" parameterType="com.daou.moyeo.dto.ScheduleDTO">
		INSERT INTO SCHEDULE_TB(
			MEMBER_NO, 
			GROUP_NO, 
			SCHEDULE_DAY, 
			SCHEDULE_START_TIME, 
			SCHEDULE_FINISH_TIME,
			WEEK_START_DATE
		)
		VALUES
		<foreach collection="scheduleInfos" item="item" separator=",">
		(
			#{memberNo}, 
			#{groupNo}, 
			#{item.scheduleDay},
			#{item.scheduleStartTime},
			#{item.scheduleFinishTime},
			#{weekStartDate}
		)
		</foreach>
	</insert>

	<resultMap type="hashmap" id="scheduleList">
		<result property="title" column="TITLE" javaType="java.lang.String"/>
		<result property="start" column="START" javaType="java.lang.String"/>
		<result property="end" column="END" javaType="java.lang.String"/>
	</resultMap>
	
	<select id="selectScheduleList" parameterType="hashmap" resultMap="scheduleList">
		SELECT 
			'등록된 일정' AS TITLE,
			DATE_ADD( DATE_ADD(WEEK_START_DATE, INTERVAL +SCHEDULE_DAY DAY), INTERVAL +SCHEDULE_START_TIME HOUR ) AS START,
			DATE_ADD( DATE_ADD(WEEK_START_DATE, INTERVAL +SCHEDULE_DAY DAY), INTERVAL +SCHEDULE_FINISH_TIME+1 HOUR ) AS END
		FROM SCHEDULE_TB
		WHERE MEMBER_NO = #{memberNo}
		AND		GROUP_NO = #{groupNo}
		AND		WEEK_START_DATE = #{startDate}
	</select>
</mapper>